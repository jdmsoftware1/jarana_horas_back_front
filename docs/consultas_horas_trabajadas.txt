# CONSULTAS DE HORAS TRABAJADAS - SISTEMA AliadaDigital

## Â¿QuÃ© son las horas trabajadas?

El sistema AliadaDigital calcula automÃ¡ticamente las horas trabajadas de cada empleado basÃ¡ndose en sus registros de entrada (checkin) y salida (checkout).

## Tipos de horas

### Horas Reales
Son las horas que el empleado realmente trabajÃ³, calculadas desde sus fichajes:
- Se suman todos los perÃ­odos entre checkin y checkout
- Solo se cuentan pares completos (entrada + salida)
- Se muestran en formato: Xh Ym (ejemplo: 8h 30m)

### Horas Estimadas
Son las horas que el empleado deberÃ­a trabajar segÃºn su horario asignado:
- Se calculan desde el horario base del empleado
- Se restan los descansos configurados
- Representan la jornada laboral esperada

### Diferencia (Horas Extra o DÃ©ficit)
Es la comparaciÃ³n entre horas reales y estimadas:
- **Horas Extra**: Cuando trabajÃ³ MÃS de lo esperado (diferencia positiva)
- **DÃ©ficit**: Cuando trabajÃ³ MENOS de lo esperado (diferencia negativa)
- Se muestra con + o - segÃºn el caso

## PerÃ­odos de consulta

### Hoy
- Muestra las horas del dÃ­a actual
- Se actualiza en tiempo real
- Ãštil para control diario

### Esta Semana
- PerÃ­odo de Lunes a Domingo
- Suma todas las horas de la semana en curso
- Ideal para seguimiento semanal

### Este Mes
- Desde el dÃ­a 1 del mes hasta hoy
- Acumulado mensual
- Ãštil para nÃ³minas y reportes

## Consultas que puedes hacer

### Consultas por empleado especÃ­fico
- "Â¿CuÃ¡ntas horas trabajÃ³ Juan hoy?"
- "Â¿CuÃ¡ntas horas lleva MarÃ­a esta semana?"
- "Horas trabajadas de Pedro este mes"
- "Â¿Juan tiene horas extra?"

### Consultas generales
- "Â¿QuiÃ©n hizo mÃ¡s horas esta semana?"
- "MuÃ©strame el ranking de horas trabajadas"
- "Â¿QuÃ© empleados tienen horas extra?"
- "Â¿Hay empleados con dÃ©ficit de horas?"
- "Resumen de horas trabajadas del equipo"

### Consultas de anÃ¡lisis
- "Â¿QuiÃ©n tiene mÃ¡s horas extra este mes?"
- "Empleados con dÃ©ficit de horas"
- "Comparativa de horas trabajadas"
- "EstadÃ­sticas de cumplimiento de horario"

## CÃ³mo se calculan

### Paso 1: Obtener registros
El sistema busca todos los registros de checkin y checkout del empleado en el perÃ­odo solicitado.

### Paso 2: Emparejar entradas y salidas
- Se empareja cada checkin con su checkout correspondiente
- Si hay un checkin sin checkout, no se cuenta (jornada incompleta)

### Paso 3: Sumar tiempos
- Se calcula la diferencia entre cada par checkin-checkout
- Se suman todas las diferencias
- Resultado: Total de minutos trabajados

### Paso 4: Convertir a horas y minutos
- Se divide entre 60 para obtener horas
- El resto son los minutos
- Formato final: Xh Ym

### Paso 5: Comparar con horario estimado
- Se obtiene el horario asignado al empleado
- Se calculan las horas que deberÃ­a trabajar
- Se compara con las horas reales
- Se muestra la diferencia

## Ejemplos de respuestas

### Ejemplo 1: Consulta individual
Pregunta: "Â¿CuÃ¡ntas horas trabajÃ³ Juan hoy?"

Respuesta:
```
HORAS TRABAJADAS: Juan PÃ©rez

HOY (10/11/2024):
- Horas trabajadas: 8h 30m
- Horas estimadas: 8h 0m
- Horas extra: +0h 30m âœ…
```

### Ejemplo 2: Ranking
Pregunta: "Â¿QuiÃ©n hizo mÃ¡s horas esta semana?"

Respuesta:
```
RANKING DE HORAS TRABAJADAS (ESTA SEMANA):

1. Juan PÃ©rez: 42h 15m
2. MarÃ­a GarcÃ­a: 41h 30m
3. Pedro LÃ³pez: 40h 0m
4. Ana MartÃ­nez: 38h 45m
```

### Ejemplo 3: Horas extra
Pregunta: "Â¿QuÃ© empleados tienen horas extra este mes?"

Respuesta:
```
EMPLEADOS CON HORAS EXTRA (ESTE MES):

- Juan PÃ©rez: +5h 30m âœ…
- MarÃ­a GarcÃ­a: +3h 15m âœ…
- Pedro LÃ³pez: +2h 0m âœ…
```

### Ejemplo 4: DÃ©ficit
Pregunta: "Â¿Hay empleados con dÃ©ficit de horas?"

Respuesta:
```
EMPLEADOS CON DÃ‰FICIT DE HORAS (ESTA SEMANA):

- Ana MartÃ­nez: -2h 30m âš ï¸
- Carlos Ruiz: -1h 15m âš ï¸
```

## DÃ³nde ver las horas en el dashboard

### Tabla de empleados
En la pestaÃ±a "Empleados" del Dashboard de Administrador, hay una columna "Horas Trabajadas" que muestra:
- Hoy: Xh Ym
- Semana: Xh Ym
- Mes: Xh Ym

### Modal de anÃ¡lisis
Haciendo click en el botÃ³n "ğŸ“Š AnÃ¡lisis" de cada empleado, se abre un modal detallado con:
- Horas estimadas vs reales
- Diferencia (extra o dÃ©ficit)
- Porcentaje de cumplimiento
- Desglose por dÃ­a/semana/mes

## Casos especiales

### Empleado sin horario asignado
Si un empleado no tiene horario configurado:
- Se muestran las horas reales trabajadas
- No se pueden calcular horas estimadas
- No hay comparaciÃ³n de extra/dÃ©ficit

### Jornadas incompletas
Si hay un checkin sin checkout:
- Esa jornada no se cuenta en el total
- Se considera incompleta
- No afecta al cÃ¡lculo de otras jornadas

### DÃ­as festivos o vacaciones
Los dÃ­as festivos o de vacaciones:
- No se cuentan en las horas estimadas
- Si el empleado fichÃ³, se cuentan las horas reales
- Pueden generar horas extra si trabajÃ³ en dÃ­a libre

## Beneficios del sistema

1. **Control automÃ¡tico**: No necesitas calcular manualmente
2. **Tiempo real**: InformaciÃ³n siempre actualizada
3. **PrecisiÃ³n**: CÃ¡lculos exactos al minuto
4. **Transparencia**: Empleados y managers ven la misma informaciÃ³n
5. **Facilita nÃ³minas**: Datos listos para procesar pagos
6. **Detecta anomalÃ­as**: Identifica rÃ¡pidamente excesos o dÃ©ficits

## Preguntas frecuentes

### Â¿Se cuentan los descansos?
No, los descansos configurados en el horario se restan automÃ¡ticamente de las horas estimadas.

### Â¿QuÃ© pasa si olvido fichar la salida?
Esa jornada no se contarÃ¡ hasta que se registre la salida. Puedes aÃ±adir el registro manualmente.

### Â¿Puedo ver las horas de otros empleados?
Solo si eres administrador o manager. Los empleados solo ven sus propias horas.

### Â¿Con quÃ© frecuencia se actualizan?
En tiempo real. Cada vez que hay un nuevo fichaje, se recalculan automÃ¡ticamente.

### Â¿Se pueden exportar los datos?
Actualmente se muestran en el dashboard. La exportaciÃ³n a Excel/PDF estÃ¡ en desarrollo.
